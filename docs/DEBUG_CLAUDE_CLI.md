# –û—Ç–ª–∞–¥–∫–∞ Claude CLI

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∫ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–ø—É—Å–∫–æ–º Claude –∞–≥–µ–Ω—Ç–∞.

## –°–∏–º–ø—Ç–æ–º—ã

- Claude –∞–≥–µ–Ω—Ç –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è —Å `exit code -9`
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ "Previous attempt failed with error: exit code -9"
- –ù–µ—Ç –≤—ã–≤–æ–¥–∞ –æ—Ç Claude –∞–≥–µ–Ω—Ç–∞

## –ü—Ä–∏—á–∏–Ω—ã exit code -9

Exit code -9 –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª —É–±–∏—Ç —Å–∏–≥–Ω–∞–ª–æ–º SIGKILL. –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–ù–µ—Ö–≤–∞—Ç–∫–∞ –ø–∞–º—è—Ç–∏ (OOM Killer)** - —Å–∏—Å—Ç–µ–º–∞ —É–±–∏–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å –∏–∑-–∑–∞ –Ω–µ—Ö–≤–∞—Ç–∫–∏ –ø–∞–º—è—Ç–∏
2. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ** - –ø—Ä–æ—Ü–µ—Å—Å –±—ã–ª —É–±–∏—Ç –≤—Ä—É—á–Ω—É—é (kill -9)
3. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è** - cgroups limits, ulimit –∏ —Ç.–¥.
4. **–ü—Ä–æ–±–ª–µ–º—ã —Å Claude CLI** - –±–∏–Ω–∞—Ä–Ω–∏–∫ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω –∏–ª–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Claude CLI

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python scripts/test_claude_cli.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç:
- –ù–∞–ª–∏—á–∏–µ Claude CLI –≤ PATH –∏–ª–∏ CLAUDE_CLI_PATH
- –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
- –†–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å `--version`
- –ó–∞–ø—É—Å–∫ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –ø—Ä–æ–º–ø—Ç–æ–º

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Django

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ workflow –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
# –í Docker
docker logs web_rA_web_1 2>&1 | grep -A 10 "–î–ï–¢–ê–õ–¨–ù–ê–Ø –û–¢–õ–ê–î–ö–ê CLI"

# –ù–∞ —Ö–æ—Å—Ç–µ
tail -f logs/django.log | grep -A 10 "–î–ï–¢–ê–õ–¨–ù–ê–Ø –û–¢–õ–ê–î–ö–ê CLI"
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
- üîç –î–ï–¢–ê–õ–¨–ù–ê–Ø –û–¢–õ–ê–î–ö–ê CLI –ó–ê–ü–£–°–ö–ê
- üéØ –ü–û–õ–ù–ê–Ø –ö–û–ú–ê–ù–î–ê
- üåç –ü–ï–†–ï–ú–ï–ù–ù–´–ï –û–ö–†–£–ñ–ï–ù–ò–Ø
- üìÑ MCP CONFIG –°–û–î–ï–†–ñ–ò–ú–û–ï
- üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞
- üìñ –ù–∞—á–∏–Ω–∞–µ–º —á–∏—Ç–∞—Ç—å –≤—ã–≤–æ–¥
- üì• –°—Ç—Ä–æ–∫–∞ #N (–∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ –æ—Ç Claude)
- üì¶ JSON –æ—Ç–≤–µ—Ç #N (JSON —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç Claude)
- üèÅ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å exit_code=X

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤

#### –ü–∞–º—è—Ç—å

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏
free -h

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ OOM killer
dmesg | grep -i "killed process"
sudo journalctl -k | grep -i "out of memory"
```

#### –î–∏—Å–∫

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
df -h
```

#### –õ–∏–º–∏—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ ulimit
ulimit -a

# –í Docker –ø—Ä–æ–≤–µ—Ä–∫–∞ memory limits
docker stats
```

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ Claude CLI –Ω–∞–ø—Ä—è–º—É—é

–ó–∞–ø—É—Å—Ç–∏—Ç–µ Claude CLI –≤—Ä—É—á–Ω—É—é —Å —Ç–µ–º –∂–µ –ø—Ä–æ–º–ø—Ç–æ–º:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
export CLAUDE_CLI_PATH=/home/lunix/.local/bin/claude

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -lh $CLAUDE_CLI_PATH

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º –ø—Ä–æ–º–ø—Ç–æ–º
$CLAUDE_CLI_PATH -p "Say hello"

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å MCP –∫–æ–Ω—Ñ–∏–≥–æ–º
$CLAUDE_CLI_PATH -p --mcp-config /path/to/mcp_config.json "Test prompt"
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ MCP –∫–æ–Ω—Ñ–∏–≥–∞

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ MCP –∫–æ–Ω—Ñ–∏–≥ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π:

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞
ls -lh /mnt/c/work_ai/agent_projects/web_rA/agent_projects/*/mcp_config.json

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
cat /mnt/c/work_ai/agent_projects/web_rA/agent_projects/*/mcp_config.json | jq .

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Python —Å–∫—Ä–∏–ø—Ç –¥–ª—è MCP —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -lh /app/manage.py  # –∏–ª–∏ –ø—É—Ç—å –∏–∑ mcp_config.json
```

## –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤—ã –±—É–¥–µ—Ç–µ –≤–∏–¥–µ—Ç—å –≤ –∫–æ–Ω—Å–æ–ª–∏:

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º
```
[DEBUG] üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞: /home/lunix/.local/bin/claude
[DEBUG] üéØ –ü–æ–ª–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: /home/lunix/.local/bin/claude -p --mcp-config /path/to/mcp_config.json "–ø—Ä–æ–º–ø—Ç"
[DEBUG] ‚úÖ –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω —É—Å–ø–µ—à–Ω–æ, PID: 12345
```

### –í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```
[DEBUG] üìñ –ù–∞—á–∏–Ω–∞–µ–º —á–∏—Ç–∞—Ç—å –≤—ã–≤–æ–¥ –ø—Ä–æ—Ü–µ—Å—Å–∞ PID=12345
[DEBUG] üì• –°—Ç—Ä–æ–∫–∞ #1: {"type":"assistant","message":{"content":[...]}}
[DEBUG] üì¶ JSON #1: type=assistant, subtype=
[DEBUG] üí¨ Assistant: –ü—Ä–∏–≤–µ—Ç! –ö–∞–∫ –¥–µ–ª–∞?
[DEBUG] üì• –°—Ç—Ä–æ–∫–∞ #2: {"type":"tool_call","tool_name":"server_execute"}
[DEBUG] üì¶ JSON #2: type=tool_call, subtype=started
[DEBUG] üîß Tool call: server_execute
```

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
```
[DEBUG] üèÅ Exit code=0
[DEBUG] üìä –ó–ê–í–ï–†–®–ï–ù–ò–ï: exit_code=0, —Å—Ç—Ä–æ–∫=25, —Ä–∞–∑–º–µ—Ä=12345
```

### –ü—Ä–∏ –æ—à–∏–±–∫–µ
```
[DEBUG] üèÅ Exit code=-9
[DEBUG] ‚ö†Ô∏è –û–®–ò–ë–ö–ê! exit_code=-9
```

## –†–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: Claude CLI –Ω–µ –Ω–∞–π–¥–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Claude CLI: https://docs.anthropic.com/claude/cli
2. –î–æ–±–∞–≤—å—Ç–µ –≤ PATH –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ CLAUDE_CLI_PATH –≤ .env:
   ```bash
   CLAUDE_CLI_PATH=/home/lunix/.local/bin/claude
   ```
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
   ```bash
   chmod +x /home/lunix/.local/bin/claude
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Exit code -9 (OOM)

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–≤–µ–ª–∏—á—å—Ç–µ –ø–∞–º—è—Ç—å Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
   ```yaml
   # docker-compose.yml
   services:
     web:
       mem_limit: 4g
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ swap:
   ```bash
   sudo swapon -s
   # –ï—Å–ª–∏ swap –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞–π—Ç–µ
   sudo fallocate -l 4G /swapfile
   sudo chmod 600 /swapfile
   sudo mkswap /swapfile
   sudo swapon /swapfile
   ```

3. –£–º–µ–Ω—å—à–∏—Ç–µ –Ω–∞–≥—Ä—É–∑–∫—É - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—å—à—É—é –º–æ–¥–µ–ª—å Claude

### –ü—Ä–æ–±–ª–µ–º–∞: MCP –∫–æ–Ω—Ñ–∏–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç JSON:
   ```bash
   cat mcp_config.json | jq .
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ - –æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–º–∏

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Python –∏ manage.py –¥–æ—Å—Ç—É–ø–Ω—ã:
   ```bash
   python /app/manage.py mcp_servers --help
   ```

### –ü—Ä–æ–±–ª–µ–º–∞: Claude CLI –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é Claude CLI:
   ```bash
   $CLAUDE_CLI_PATH auth status
   ```

2. –ü–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å:
   ```bash
   $CLAUDE_CLI_PATH auth login
   ```

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–≤–æ—Ç—ã API

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏

–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ —Ä–µ—à–∞–µ—Ç—Å—è:
1. –°–æ–±–µ—Ä–∏—Ç–µ –≤—Å–µ –ª–æ–≥–∏: `python scripts/test_claude_cli.py > test_output.txt`
2. –°–æ–±–µ—Ä–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é: `free -h && df -h && ulimit -a > system_info.txt`
3. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ Django –∏–∑ UI –∏–ª–∏ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª
4. –û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤
